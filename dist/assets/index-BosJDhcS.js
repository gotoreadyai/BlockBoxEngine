import{r as e,j as t,R as n}from"./react-CYM50T_J.js";import{c as r}from"./react-dom-CVSfZYju.js";import{c as a}from"./zustand-B9swZzWH.js";import{E as o,S as i,A as s,V as l,a as c,D as d,C as u,L as h,b as m,c as p,d as x,T as f,M as g,e as v,f as b,g as w,P as y,h as S,i as j,j as T}from"./@babylonjs-IfLBMaP_.js";import{F as C,a as N}from"./react-icons-CDMk7YDv.js";import{d as B}from"./compress-json-BSyRvo9O.js";import"./scheduler-DhxmCZ7v.js";import"./use-sync-external-store-CrqN-JHg.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const P=a((()=>({route:"start",currentChunk:"chunk01",fps:"0",blocks:[[1,1,1],[0,1,1],[0,1,1],[0,1,1],[0,1,1],[0,1,1],[0,1,1]],selectedBlock:0})));function L({handleReact:n}){const r=e.useCallback((e=>{"Tab"===e.key&&P.setState((()=>({route:"voxel-preview"===P.getState().route?"voxel-editor":"voxel-preview"}))),e.preventDefault()}),[]);return e.useEffect((()=>(document.addEventListener("keydown",r,!1),()=>{document.removeEventListener("keydown",r,!1)})),[r]),t.jsx("input",{type:"hidden"})}const k=({antialias:n,engineOptions:r,adaptToDeviceRatio:a,sceneOptions:s,onRender:l,onSceneReady:c,...d})=>{const u=e.useRef(null);return e.useEffect((()=>{const{current:e}=u;if(e)try{const t=new o(e,n=!0,r,a=!0),d=new i(t,s);t.onContextLostObservable,d.blockMaterialDirtyMechanism=!0,d.blockfreeActiveMeshesAndRenderingGroups=!0,d.getAnimationRatio(),d.isReady()?c(d):d.onReadyObservable.addOnce((e=>c(e))),t.runRenderLoop((()=>{"function"==typeof l&&l(d),P.setState((()=>({fps:t.getFps().toFixed()+" fps"}))),d.render()}));const u=()=>{d.getEngine().resize()};return window.addEventListener("resize",u),()=>{d.getEngine().dispose(),window.removeEventListener("resize",u)}}catch(t){}}),[n,r,a,s,l,c]),t.jsx("canvas",{className:"block w-full h-full outline-none",ref:u,...d})},A=e=>{const t=new s("mainArcRotateCamera",Math.PI/2,Math.PI/5,40,l.Zero(),e);return t.attachControl(e.getEngine().getRenderingCanvas(),!0),t.lowerBetaLimit=c.FromDegrees(0).radians(),t.upperBetaLimit=c.FromDegrees(90).radians(),t.useBouncingBehavior=!0,t},E=e=>{const t=new d("mainLight",new l(-1,-2,-1),e);t.position=new l(0,7,7),t.intensity=7,t.diffuse=new u(1,1,1),t.specular=new u(.4,.2,.5);const n=new h;return n.scaleRatio=1,n.light=t,t},M=e=>{const t=new d("hemiBackupLight",new l(1,0,0),e);t.intensity=.75,t.position=new l(-7,0,0);const n=new d("hemiBackupLight",new l(-1,0,0),e);n.intensity=.75,n.position=new l(7,0,0);const r=new d("hemiBackupLight",new l(1,0,2),e);return r.intensity=.25,r.position=new l(0,0,-7),t},R=e=>{const t=new m(256,e);return e.shadowMaxZ=128,e.shadowMinZ=0,t.normalBias=.65,t.setDarkness(.05),t.bias=.005,t.useContactHardeningShadow=!0,t.filteringQuality=m.QUALITY_LOW,t.useBlurExponentialShadowMap=!0,t.blurScale=1,t.blurBoxOffset=2,t};function O({index:e}){const n=[],r=P((e=>e.blocks)),a=P((e=>e.selectedBlock));for(let i=0;i<6;i++)n.push(t.jsx("div",{style:{imageRendering:"pixelated",backgroundImage:"url('/tiles.png')",backgroundSize:"142px",backgroundPosition:`-${24*i}px -${24*e}px`},className:"w-6 h-6 border border-gray-950"},i));return t.jsxs("div",{onClick:()=>P.setState({selectedBlock:e}),className:(a===e?"bg-zinc-700":"bg-zinc-800 hover:bg-lime-800 cursor-pointer")+" py-1.5 p-1.5 flex items-center gap-px ",children:[t.jsxs("span",{className:"flex-1",children:["BLOCK ",e]}),t.jsx("input",{onChange:t=>{const n=[...r];n[e]=t.target.value.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((e,t,n,r)=>"#"+t+t+n+n+r+r)).substring(1).match(/.{2}/g).map((e=>Math.round(parseInt(e,16)/255*10)/10)),P.setState({blocks:n})},className:"bg-gray-700 p-px appearance-none h-6 w-8",type:"color",name:"color",value:(o=r[e],"#"+o.map((e=>{const t=Math.round(255*e).toString(16);return 1===t.length?"0"+t:t})).join(""))}),n]});var o}const z=e=>{p.ShadersStore.customVertexShader="\n    precision highp float;\n    #extension GL_EXT_draw_buffers : require\n\n    attribute vec3 position;\n    attribute vec3 normal;\n    attribute vec2 uv;\n    attribute vec2 uv2;\n   attribute vec4 color2;\n\n    uniform mat4 viewProjection;\n    uniform mat4 worldViewProjection;\n    uniform mat4 lightViewProjection;\n    uniform vec3 lightPosition; \n    \n    varying vec3 vPositionW;\n    varying vec3 vNormalW;\n    varying vec2 vUV;\n    varying vec3 vLightVectorW; \n    varying vec4 bufferColor; \n\n    varying vec4 vShadowCoord; \n\n    #include<instancesDeclaration>\n    #include<helperFunctions>\n    #include<__decl__lightFragment>[0..1]\n    #include<shadowsFragmentFunctions>\n    \n    void main(void) {\n    #include<instancesVertex>\n    #include<shadowsVertex>[0]\n\n    vec4 worldPosition = finalWorld * vec4(position, 1.0);\n    vPositionW = vec3(worldPosition);\n    vLightVectorW = normalize(lightPosition - vPositionW);\n    vNormalW = normalize(mat3(finalWorld) * normal);\n    vShadowCoord = lightViewProjection * finalWorld * vec4(vPositionW, 0.01); \n    \n    vUV = uv + uv2;\n    bufferColor = color2;  // Pass color2 to fragment shader\n\n   \n\n    \n    gl_Position = viewProjection * worldPosition;\n\n    }\n  ",p.ShadersStore.customFragmentShader="\n  precision highp float;\n  uniform sampler2D textureSampler;\n  uniform sampler2D shadowSampler;\n  uniform float lightIntensity;\n  uniform float TT[4];\n  uniform float TBL[5];\n\n  varying vec2 vUV;\n  varying vec4 bufferColor;  // Receive color2 from vertex shader\n\n  varying vec3 vPositionW;\n  varying vec3 vNormalW;\n  varying vec3 vLightVectorW;\n  varying vec4 vShadowCoord;\n\nfloat unpackDepth(const in vec4 rgbaDepth) {\n    const vec4 bitShift = vec4(0.75, 0.1 / 255.0, 0.1 / (255.0 * 255.0), 0.1 / (255.0 * 255.0 * 255.0));\n    float depth = dot(rgbaDepth, bitShift);\n    return depth;\n}\n\nvoid main() {\n  \n    vec3 shadowCoord = vShadowCoord.xyz / vShadowCoord.w;\n    shadowCoord = vNormalW * vPositionW * shadowCoord *  0.5 + 0.25;\n   \n    float shadow = 0.75;\n    \n    if (shadowCoord.z < 1.0) {\n        float shadowDepth = unpackDepth(texture2D(shadowSampler, shadowCoord.xy));\n        shadow = shadowDepth < shadowCoord.z ? 0.7 : 1.0;\n    }\n\n    // Light\n    float ndl = max(0.0, dot(vNormalW, vLightVectorW));\n    vec3 textureColor = texture2D(textureSampler, vUV).rgb;\n    \n    \n    // Cartoon effect\n    if (ndl > TT[0]) { textureColor *= TBL[0]; }\n    else if (ndl > TT[1]) { textureColor *= TBL[1]; }\n    else if (ndl > TT[2]) { textureColor *= TBL[2]; }\n    else if (ndl > TT[3]) { textureColor *= TBL[3]; }\n    else { textureColor *= TBL[4]; }\n\n\n    vec3 burn = vec3(1,1,1);\n\n    if (textureColor.r < 0.6) {\n      burn *= vec3(bufferColor.g * 1.25, bufferColor.g * 1.25, bufferColor.b * 1.25);\n    } else{\n      burn = vec3(0.8,0.8,0.8);\n      shadow *= 1.25;\n    }\n    \n    // textureColor *= lightIntensity * shadow * vPositionW;\n    textureColor *= shadow *  0.9;  \n\n    float blurRadius = 0.01;\n    float texOffset = 0.5;\n    for (float x = -blurRadius; x <= blurRadius; x++) {\n        textureColor += texture2D(textureSampler, vUV + vec2(x, 0) * texOffset).rgb * vec3(0.25,0.25,0.25);\n    }\n\n   \n    \n    gl_FragColor = vec4( textureColor * burn , 1) * bufferColor; \n\n\n}\n\n  \n  ";const t=new x("custom",e,{vertex:"custom",fragment:"custom"},{attributes:["position","normal","uv","uv2","color2"],uniforms:["world","worldView","worldViewProjection","view","projection","viewProjection","lightIntensity","lightPosition","lightViewProjection","TT","TBL"],samplers:["textureSampler","shadowSampler"]}),n=new f("/tiles.png",e,!0,!1,f.NEAREST_SAMPLINGMODE);t.setTexture("textureSampler",n),t.setFloat("lightIntensity",.5);const r=new f("/minishadow.png",e,!0,!1,f.NEAREST_SAMPLINGMODE);t.setTexture("shadowSampler",r);const a=new d("dirLight",new l(-1,-1,-1),e);a.position=new l(20,40,20);const o=new m(0,a);e.meshes.forEach((e=>{(e=>{e instanceof g&&(e.receiveShadows=!0,o.addShadowCaster(e))})(e)})),t.setVector3("lightPosition",a.position),t.setMatrix("lightViewProjection",a.getShadowGenerator().getTransformMatrix());return e.onBeforeRenderObservable.add((()=>{const n=e.activeCamera;if(!n)return;e.meshes.forEach((e=>{const r=(a=e.position,l.Distance(a,n.position));var a;const o=1-Math.min(r/150,1),i=[.95,.5,.2,.1,.03].map((e=>e*o)),s=[1.5,1.2,1,.7,.5].map((e=>.6*e));t.setFloats("TT",i),t.setFloats("TBL",s)}))})),t},D=(e,t)=>new S(e/6,t/7,(e+1)/6,(t+1)/7),I=(e,t)=>new S((e+1)/6,(t+1)/7,e/6,t/7),F=(e,t,n,r)=>{const a=v.CreateBox("chunkHelper",{size:15},r);a.material=new b("material"),a.material.alpha=0,a.showBoundingBox=!0,a.receiveShadows=!1,a.isPickable=!1,a.position.x=15*e[0],a.position.y=15*e[1],a.position.z=15*e[2];const o=v.CreatePlane("plane",{size:1},r);o.position.y=1,o.billboardMode=2;const i=new b("material",r),s=new f("/bilboard.png",r,!0,!1,f.NEAREST_SAMPLINGMODE);i.ambientTexture=s,i.opacityTexture=s,s.hasAlpha=!0,o.material=i;const l=v.CreateBox("mesh",{size:1,faceUV:[I(0,0),I(1,0),I(2,0),I(3,0),D(4,0),D(5,0)],wrap:!0},r);return l.previousWorldMatrixInstancedBuffer,l.material=z(r),l.receiveShadows=!0,l.thinInstanceEnablePicking=!0,l.parent=a,V(t,l),n.addShadowCaster(l),{voxelMesh:l,chunkHelper:a}},V=(e,t)=>{const n=new Float32Array(16*e.length),r=new Float32Array(2*e.length),a=new Float32Array(4*e.length);return e.forEach(((e,t)=>{w.Translation(1*e[0],1*e[1],1*e[2]).copyToArray(n,16*t),r.set([0,e[3]/7],2*t),a.set([e[4],e[5],e[6],1],4*t)})),t.thinInstanceSetBuffer("matrix",n),t.thinInstanceSetBuffer("uv2",r,2),t.thinInstanceSetBuffer("color2",a,4),t},W=(e,t,n,r)=>{const a=e=>e[0]>=-7&&e[0]<=7&&e[1]>=-7&&e[1]<=7&&e[2]>=-7&&e[2]<=7;e.onPointerObservable.add((o=>{if(o.type===y.POINTERDOWN){var i=e.pick(e.pointerX,e.pointerY,(e=>e===n));if((null==i?void 0:i.hit)&&void 0!==i.thinInstanceIndex){const e=i.thinInstanceIndex,l=[t[e][0],t[e][1],t[e][2]],c=i.getNormal(!0);if(c&&"voxel-editor"===P.getState().route){const r=P.getState().blocks,i=P.getState().selectedBlock;if(0===o.event.button){const e=[l[0]+Math.round(c.x),l[1]+Math.round(c.y),l[2]+Math.round(c.z)];if(a(e)){let a=1;((e,t,n,r,a)=>{r.push([...e,t,...n]),V(r,a),localStorage.setItem("VOXELS",JSON.stringify(r))})(e,i,[...r[i],a],t,n),s=e,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]].map((([e,t,n])=>[s[0]+e,s[1]+t,s[2]+n]))}}else 2===o.event.button&&a(l)&&((e,t,n)=>{t.splice(e,1),V(t,n),localStorage.setItem("VOXELS",JSON.stringify(t))})(e,t,n)}c&&"voxel-preview"===P.getState().route&&(r.position.x=l[0],r.position.y=l[1],r.position.z=l[2])}}var s}))},_=[{id:"center",label:"center",min:-.5,max:.5,step:.01,parentBone:"root",rotationAxis:j.X,default:0},{id:"belly",label:"belly",min:-.5,max:.5,step:.01,parentBone:"center",rotationAxis:j.Y,default:0},{id:"chest",label:"chest",min:-.5,max:.5,step:.01,parentBone:"belly",rotationAxis:j.Z,default:0},{id:"neckBottom",label:"neckBottom",min:-.5,max:.5,step:.01,parentBone:"chest",rotationAxis:j.Z,default:0},{id:"neckTop",label:"neckTop",min:-.5,max:.5,step:.01,parentBone:"neckBottom",rotationAxis:j.X,default:0},{id:"head",label:"head",min:-.5,max:.5,step:.01,parentBone:"neckTop",rotationAxis:j.Y,default:0},{id:"rightShoulder1",label:"rightShoulder1",min:-.9,max:.9,step:.01,parentBone:"rightShoulderPin1",rotationAxis:j.Z,default:0},{id:"rightShoulder2",label:"rightShoulder2",min:-.9,max:.9,step:.01,parentBone:"rightShoulderPin2",rotationAxis:j.Y,default:0},{id:"rightShoulder3",label:"rightShoulde3",min:-.5,max:.5,step:.01,parentBone:"rightShoulderPin3",rotationAxis:j.Z,default:0},{id:"rightShoulder4",label:"rightShoulde4",min:-.5,max:.5,step:.01,parentBone:"rightArm",rotationAxis:j.Z,default:0},{id:"rightHipPin",label:"rightHipPin",min:-.5,max:.5,step:.01,parentBone:"rightHipPin",rotationAxis:j.Z,default:0},{id:"rightHip",label:"rightHip",min:-.5,max:.5,step:.01,parentBone:"rightHip",rotationAxis:j.X,default:0},{id:"rightLeg",label:"rightLeg",min:-.5,max:.5,step:.01,parentBone:"rightLeg",rotationAxis:j.X,default:0},{id:"leftShoulder1",label:"leftShoulder1",min:-.9,max:.9,step:.01,parentBone:"leftShoulderPin1",rotationAxis:j.Z,default:0},{id:"leftShoulder2",label:"leftShoulder2",min:-.9,max:.9,step:.01,parentBone:"leftShoulderPin2",rotationAxis:j.Y,default:0},{id:"leftShoulder3",label:"leftShoulde3",min:-.5,max:.5,step:.01,parentBone:"leftShoulderPin3",rotationAxis:j.Z,default:0},{id:"leftShoulder4",label:"leftShoulde4",min:-.5,max:.5,step:.01,parentBone:"leftArm",rotationAxis:j.Z,default:0}];w.Translation(0,0,0),w.Translation(0,.4,0),w.Translation(0,0,0),w.Translation(0,.2,0),w.Translation(0,.2,0),w.Translation(0,0,.355),w.Translation(0,.1,0),w.Translation(.35,.1,0),w.Translation(0,0,0),w.Translation(0,0,0),w.Translation(.3,.1,0),w.Translation(.15,0,0),w.Translation(0,0,0),w.Translation(-.35,.1,0),w.Translation(0,0,0),w.Translation(0,0,0),w.Translation(-.3,.1,0),w.Translation(-.15,0,0),w.Translation(0,0,0),w.Translation(0,0,0),w.Translation(0,0,0),w.Translation(0,-.2,0),w.Translation(0,0,0),w.Translation(0,0,0),w.Translation(0,0,0),w.Translation(0,-.2,0),w.Translation(0,0,0);const H=(e,t,n)=>{const r=_.find((e=>e.id===t));r&&n.bones[r.parentBone].setAxisAngle(r.rotationAxis,Math.sin(e)*Math.PI)},X=({handleState:n})=>{const[r,a]=e.useState(_);return t.jsx("div",{className:"flex flex-col gap-3 mt-2 px-3 text-xs",children:_.map(((e,a)=>t.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[t.jsx("span",{className:"uppercase",children:e.label}),t.jsx("input",{className:"appearance-none h-4 rounded bg-gray-800",min:r[a].min,max:r[a].max,step:r[a].step,defaultValue:r[a].default,type:"range",onChange:e=>{const t=r;t[a].default=e.target.value,n({type:"bones",data:t,index:a})}})]},a)))})},K=({keyframes:n,currentFrame:r,setCurrentFrame:a,addKeyframe:o})=>{const i=e.useRef(null);e.useEffect((()=>{if(i.current){const e=11*r-i.current.clientWidth/2;i.current.scrollTo({left:e,behavior:"smooth"})}}),[r]);const s=e=>{if(e===r)return"bg-blue-500";return n.some((t=>t.frame===e))?"bg-red-500":e%2==0?"bg-gray-300":"bg-gray-400"};return t.jsxs("div",{className:"flex-1",children:[t.jsx("button",{className:"bg-blue-700 text-white text-xs px-3 py-1.5 rounded",onClick:o,children:"Add Keyframe"}),t.jsx("div",{className:"relative w-full h-8 bg-gray-800 overflow-x-hidden",onClick:e=>{const t=e.currentTarget.getBoundingClientRect(),n=e.clientX-t.left,r=Math.floor(n/11);a(r)},ref:i,children:t.jsx("div",{className:" w-full h-full flex",children:Array.from({length:100},((e,n)=>t.jsx("div",{className:`${s(n)}`,style:{width:"10px",marginRight:"1px"},onClick:()=>a(n),children:n%10==0&&t.jsx("span",{className:"text-xs absolute bottom-0",children:n})},n)))})}),t.jsxs("div",{children:["Current Frame:",t.jsx("input",{type:"number",className:"border ml-2 p-1",value:r,onChange:e=>a(Number(e.target.value))})]})]})},U=({initialKeyframes:n})=>{const[r,a]=e.useState(n),[o,i]=e.useState(0);return t.jsx("div",{className:"flex-1 flex",children:t.jsx(K,{keyframes:r,currentFrame:o,setCurrentFrame:i,addKeyframe:()=>{const e=[...r,{frame:o,value:{x:0,y:0,z:0}}];a(e)}})})};function Z({children:e,handleReact:n}){const r=P((e=>e.route)),a=P((e=>e.fps)),o=P((e=>e.blocks));return t.jsx(t.Fragment,{children:t.jsxs("div",{className:"flex flex-col w-screen h-screen fixed select-none bg-zinc-700 font-pixel",children:[t.jsxs("div",{className:"flex gap-px p-px text-gray-200 text-base bg-zinc-800",children:[t.jsx("div",{className:"py-1.5 px-3 w-80  font-black ",children:"BLOCK BOX V0.0.1"}),t.jsxs("div",{className:"flex items-center",children:["MENU ",t.jsx(C,{})," SCENE ",t.jsx(C,{})," PREVIEW"]}),t.jsx("div",{className:"flex-1"})]}),t.jsxs("div",{className:"flex flex-1 text-base mt-px",children:["start"===r&&t.jsxs("div",{className:"select-none fixed top-0 w-screen h-[calc(100vh-3rem)] flex flex-col items-center justify-center text-gray-200 gap-px text-xl",children:[t.jsx("div",{className:"bg-zinc-800 p-4 w-72",children:"WORLD"}),t.jsx("div",{className:"bg-zinc-800 p-4 w-72",children:"CHARACTER"})]}),t.jsxs("div",{className:"w-80 flex flex-col text-gray-200 gap-px text-sm",children:["voxel-preview"===r&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-zinc-800 py-1.5 px-3",children:"CHUNK 0_0_-1"}),t.jsx("div",{className:"bg-zinc-800 py-1.5 px-3",children:"CHUNK 0_0_1"}),t.jsx("div",{className:"bg-zinc-800 py-1.5 px-3",children:"CHUNK 0_0_2"}),t.jsx("div",{className:"flex-1 bg-zinc-800"})]}),"voxel-editor"===r&&t.jsx(t.Fragment,{})]}),t.jsx("div",{className:"flex-1  bg-zinc-400 ",children:e}),t.jsxs("div",{className:"w-80 flex flex-col text-gray-200 gap-px ",children:["voxel-preview"===r&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-slate-700 hover:bg-lime-600 hover:text-gray-950 px-4 gap-2 py-1 border-b-2 border-slate-600 flex items-center cursor-pointer",children:[t.jsx(N,{})," ",t.jsx("span",{children:"OPEN EDITOR [TAB]"})]}),t.jsx(X,{handleState:n})]}),"voxel-editor"===r&&t.jsxs(t.Fragment,{children:[o.map(((e,n)=>t.jsx(O,{index:n},n))),t.jsx("div",{className:"bg-zinc-800 flex-1"})]})]})]}),t.jsxs("div",{className:"flex gap-px p-px text-gray-200 text-base bg-zinc-800 mt-px",children:[t.jsx("div",{className:" py-1.5 px-3 w-80",children:a}),t.jsx(U,{initialKeyframes:[{frame:0,value:{x:0,y:1,z:0}},{frame:20,value:{x:1,y:1,z:0}},{frame:40,value:{x:0,y:1,z:1}}]})]})]})})}const G=e=>{const t=new T("sps",e,{enableDepthSort:!0}),n=v.CreateBox("m",{},e);t.addShape(n,250);const r=new b("m",e);r.alpha=.25,r.disableLighting=!0,r.emissiveColor=new u(1,1,1),n.dispose(),t.buildMesh();t.mesh.material=r;t.updateParticle=t=>{t.originalPosition||(t.position.x=200*(Math.random()-.5),t.position.y=24,t.position.z=200*(Math.random()-.5),t.scaling.x=24*Math.random(),t.scaling.y=1,t.scaling.z=24*Math.random(),t.color.r=1,t.color.g=1,t.color.b=1,t.originalPosition=t.position.clone());const n=e.getEngine().getDeltaTime();return t.position.x+=.1*n/1e3,t},t.setParticles(),t.depthSortParticles=!1,e.registerBeforeRender((()=>{t.setParticles()}))},Y=e=>{const t=v.CreateBox("targeter",{size:1.1},e),n=new b("material",e),r=new f("/selector.png",e,!0,!1,f.NEAREST_SAMPLINGMODE);return n.ambientTexture=r,n.opacityTexture=r,t.material=n,t.position.x=0,t.position.y=0,t},J=()=>{};function $(){let e,n,r,a;J();let o,i=JSON.parse(localStorage.getItem("VOXELS")||"[\n      [0, 0, 0, 0, 1, 1, 1, 0, 0],\n      [1, 0, 0, 1, 1, 1, 1, 0, 0]\n    ]");const s=e=>{"bones"===e.type&&H(e.data[e.index].default,e.data[e.index].id,undefined)};localStorage.setItem("VOXELS",JSON.stringify(i));return t.jsxs(t.Fragment,{children:[t.jsxs(Z,{handleReact:s,children:[" ",t.jsx(k,{antialias:!0,onRender:async e=>{},onSceneReady:async t=>{r=A(t),n=E(t),M(t),e=R(n),a=Y(t);const{voxelMesh:s,chunkHelper:l}=F([0,0,0],i,e,t);o=l,W(t,i,s,a),G(t),t.autoClearDepthAndStencil=!1,t.blockMaterialDirtyMechanism=!0,t.blockfreeActiveMeshesAndRenderingGroups=!0},engineOptions:{preserveDrawingBuffer:!0},adaptToDeviceRatio:!0})]}),t.jsx(L,{handleReact:s})]})}function q(){let e=window.location;return new URL(e.href).searchParams.get("project")?t.jsx($,{}):t.jsx(t.Fragment,{children:"BLOCKBOX:Project is required"})}r.createRoot(document.getElementById("root")).render(t.jsx(n.StrictMode,{children:t.jsx(q,{})}));
